### Инструкция по добавлению и обновлению сертификатов во внутреннем хранилище сертификатов Р7 Органайзер

На чистой установке запустите Р7-Органайзер для создания базового профиля, который будет впоследствии использоваться в качестве шаблона. Настройку подключения к почтовому серверу производить при создании шаблона профиля не надо!

Закройте Р7-Органайзер.

Базовый профиль создается в домашней директории пользователя. Пример расположения профиля:/home/user/.r7organizer

В указанном каталоге будут содержаться 3 вложенных каталога и 2 файла конфигурации.

Файл ``installs.ini``: содержит информацию об установках приложения в системе. Он связывает конкретные установки Р7-Органайзер с профилями, чтобы обеспечить корректную работу, если у вас установлено несколько версий программы.

Файл ``profiles.ini``: содержит информацию о доступных профилях пользователей для Р7‑Органайзер. Он необходим для управления профилями, их местоположением и активностью.

Каталог ``demo``: предназначен для хранения демонстрационного лицензионного ключа для Р7-Органайзер сроком на 30 дней с момента установки.

Каталог ``9r01ym1.default``: Служебный каталог Р7-Органайзер, наименование которого сгенерировано случайным образом, создается при первом открытии почтового клиента и используется для хранения временных меток, связанных с профилем пользователя.

Каталог ``d1gyec5d.default-default``: Основной каталог профиля пользователя, наименование которого сгенерировано случайным образом, создается при первом открытии почтового клиента и предназначен для хранения информации о профиле пользователя (сообщения, календари, настройки и т.д).

#### Добавление SSL сертификата почтового сервера в хранилище сертификатов.

Для добавления сертификата нам потребуется утилита ``certutil``

Если утилита не установлена можете установить командой
```
apt install libnss3-tools
```
Скопируйте ваши сертификаты в каталог ``/home/пользователь/.r7organizer/****.default-default/``

Папка ``.r7organizer`` создаётся при первом запуске Органайзера.

Перейдите в каталог профиля ``cd /home/пользователь/.r7organizer/****.default-default/`` и выполните команду:
```bash
certutil -A -n "Название сертификата" -t "C,C,C" -i /home/пользователь/.r7organizer/****.default-default/путь к сертификату.crt -d sql:.
```
, Где:

- A — добавить сертификат
- n — указывает имя сертификата (в кавычках)
- t — настройка доверия (для веб-сайтов, почты и программ)
- i — указывает путь к сертификату
- d sql:. — указывает базу NSS в текущей директории.

Проверьте, что сертификат добавлен:
```
bash
certutil -L -d sql:.
```
#### Добавление корневых сертификатов

<img width="1722" height="821" alt="image" src="https://github.com/user-attachments/assets/f7b24d78-8796-4d1e-b25f-3f988c478dc0" />

<img width="1728" height="1015" alt="image" src="https://github.com/user-attachments/assets/db7b9329-785c-484d-9ed8-72b5c9ed22bf" />

<img width="1734" height="922" alt="image" src="https://github.com/user-attachments/assets/db7886ee-1a6c-4687-ac5f-00b1fba9df25" />

<img width="1889" height="561" alt="image" src="https://github.com/user-attachments/assets/6f777fc0-7790-4224-9f48-d4613990eeb7" />

<img width="1729" height="1118" alt="image" src="https://github.com/user-attachments/assets/a249bd11-cc34-4bfb-a7c7-25e865e321a9" />

<img width="1727" height="973" alt="image" src="https://github.com/user-attachments/assets/61f3daba-5d47-4877-9d22-59cc7941b2a3" />

#### Включаем параметр security.enterprise_roots.enabled

Параметр security.enterprise_roots.enabled в браузере Firefox управляет тем, будет ли он использовать системное хранилище сертификатов для проверки безопасности веб-сайтов. 

Включенный (true) он позволяет браузеру доверять корпоративным корневым сертификатам, которые могут устанавливаться антивирусами или сетевыми системами безопасности, чтобы перехватывать зашифрованный трафик. 

Если этот параметр неактивен (серый) и браузер управляется организацией, это означает, что параметр установлен администратором и не может быть изменен пользователем. 

<img width="1731" height="1039" alt="image" src="https://github.com/user-attachments/assets/2caae73d-b44f-45b9-8d8a-a00e2a38a256" />

<img width="1750" height="494" alt="image" src="https://github.com/user-attachments/assets/5af7ef34-4bab-4d9e-9355-32257f38bcc7" />

> Что означает: Позволяет Firefox доверять сертификатам, установленным в операционной системе, вместо того чтобы полагаться на собственный список доверенных корневых сертификатов.
- Когда включен **(true)**: Браузер будет использовать корневые сертификаты из системного хранилища, что может быть полезно для корпоративных сетей, где трафик сканируется и перехватывается системами безопасности, например, антивирусами.
- Когда отключен **(false)**: Firefox будет использовать только свой собственный набор доверенных корневых сертификатов и может игнорировать сертификаты из системного хранилища.
- Как проверить: Введите **about:config** в адресной строке Firefox, найдите ``security.enterprise_roots.enabled`` и посмотрите, какое значение установлено **(true или false)**.



